<!--
文件目录列表
-->
<script id="fileList" type="text/html" nowith="yes">
    <section id="_container" class="wy-share-filelist-wrapper">
        <ul id="_list" class="unactive">
            <%
            var htmlEscape = require('weiyun/util/htmlEscape');
            var prettysize = require('weiyun/util/prettysize');
            var fileType = require('weiyun/util/fileType');
            var list = data.list || [];
            %>
            <%
            list.forEach(function(file){
                var is_dir = !!file['dir_key'];
                var id = is_dir ? file['dir_key'] : file['file_id'];
                var file_name = is_dir ? htmlEscape(file['dir_name']) : htmlEscape(file['filename']);
                var file_size = is_dir ? 0 : prettysize(file['file_size']);
                var file_type = is_dir ? 'folder' : fileType(file_name);
                var thumb_url = file.ext_info && file.ext_info.thumb_url;//缩略图
                var https_url = file.ext_info && file.ext_info.https_url;//缩略图https
            %>
                <li id="item_<%=id%>" data-id="item" data-file-id="<%=id%>" data-action="enter" class="wy-file-item">
                    <i <% if(thumb_url) { %> data-src="<%=thumb_url%>" data-https-src="<%=https_url%>" <% } %> class="icons-filetype icon-<%=file_type%>"></i>
                    <div class="file-describe bBor">
                        <h3 class="file-name"><%=file_name%></h3>
                        <% if(!is_dir) { %>
                        <span class="file-info">
                          <span class="file-size"><%=file_size%></span>
                        </span>
                        <% } %>
                    </div>
                    <% if(is_dir) { %>
                    <i class="icon-grey-rarr"></i>
                    <% } %>
                </li>
            <% }); %>
        </ul>
    </section>
    <div id="_load_more" class="wy-file-loading" style="display:none"><div><i class="icon icon-load"></i><span>加载中...</span></div></div>
    <div id="_toolbar"  style="display: none;">
        <div data-id="normal" class="wy-file-controller g-bottom-bar">
            <button class="btn" data-action="share" role="button">选择文件并分享</button>
        </div>
        <div data-id="confirm" class="wy-file-controller g-bottom-bar" style="display:none;">
            <button class="btn btn-certain" data-action="confirm" role="button">确定</button>
            <button class="btn btn-cancel" data-action="cancel" role="button">取消</button>
        </div>
    </div>
</script>